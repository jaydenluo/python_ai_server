# æ§åˆ¶å™¨æ‰«ææœºåˆ¶è¯´æ˜

## â“ ä¸ºä»€ä¹ˆéœ€è¦æ‰«ææ§åˆ¶å™¨ï¼Ÿ

ä½ çš„é¡¹ç›®ä½¿ç”¨äº†**è£…é¥°å™¨è·¯ç”±ç³»ç»Ÿ**ï¼ˆç±»ä¼¼ Java Spring Boot çš„æ³¨è§£è·¯ç”±ï¼‰ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„æ‰‹åŠ¨æ³¨å†Œè·¯ç”±æ–¹å¼ã€‚

### è£…é¥°å™¨è·¯ç”±ç¤ºä¾‹

```python
@api_controller(prefix="/api/auth", tags=["API - é‰´æƒæœåŠ¡"])
class AuthController(BaseController):
    
    @post("/generate")
    async def generate_auth(self, request):
        # å¤„ç†é€»è¾‘
        pass
```

### æ‰«æçš„ä½œç”¨

1. **è‡ªåŠ¨å‘ç°æ§åˆ¶å™¨**ï¼šæ‰«ææ‰€æœ‰å¸¦ `@api_controller` è£…é¥°å™¨çš„ç±»
2. **è‡ªåŠ¨æ³¨å†Œè·¯ç”±**ï¼šå°† `@get`ã€`@post`ã€`@put`ã€`@delete` è£…é¥°çš„æ–¹æ³•æ³¨å†Œåˆ° FastAPI
3. **å¦‚æœä¸æ‰«æ**ï¼šè¿™äº›æ¥å£**æ— æ³•è®¿é—®**ï¼Œä¼šè¿”å› 404 é”™è¯¯

## âœ… å¯åŠ¨æ—¥å¿—ç¤ºä¾‹

æ­£å¸¸å¯åŠ¨æ—¶ä¼šçœ‹åˆ°ï¼š

```
ğŸ” å¼€å§‹è‡ªåŠ¨æ‰«ææ§åˆ¶å™¨...
âœ… è‡ªåŠ¨æ‰«æåˆ°æ§åˆ¶å™¨: app.controller.admin.UserController
âœ… è‡ªåŠ¨æ‰«æåˆ°æ§åˆ¶å™¨: app.controller.api.AuthController
âœ… è‡ªåŠ¨æ‰«æåˆ°æ§åˆ¶å™¨: app.controller.api.UserController
âœ… æ‰«æå®Œæˆï¼Œå…±æ³¨å†Œ 17 ä¸ªè·¯ç”±
âœ… æ³¨å†Œæ§åˆ¶å™¨: UserController (10 ä¸ªè·¯ç”±)
âœ… æ³¨å†Œæ§åˆ¶å™¨: AuthController (2 ä¸ªè·¯ç”±)
```

## âš ï¸ ä¹‹å‰çš„è­¦å‘Š

```
è­¦å‘Š: æ— æ³•å¯¼å…¥æ¨¡å— app.models.entities.tts_provider_config: No module named 'app.models.base'
è­¦å‘Š: æ— æ³•å¯¼å…¥æ¨¡å— app.models.entities.tts_task: cannot import name 'BaseModel' from 'app.core.orm.models'
è­¦å‘Š: æ— æ³•å¯¼å…¥æ¨¡å— app.models.entities.tts_usage_stats: cannot import name 'BaseModel' from 'app.core.orm.models'
```

### åŸå› 

è¿™3ä¸ªæ–‡ä»¶æ˜¯æ—§ä»£ç ï¼Œä¾èµ–äº†ä¸å­˜åœ¨çš„æ¨¡å—ï¼š
- `tts_provider_config.py` - å¼•ç”¨ `app.models.base`ï¼ˆä¸å­˜åœ¨ï¼‰
- `tts_task.py`, `tts_usage_stats.py` - ä» `app.core.orm.models` å¯¼å…¥ `BaseModel`ï¼ˆè¯¥æ–‡ä»¶æ²¡æœ‰å¯¼å‡º `BaseModel`ï¼‰

### è§£å†³æ–¹æ¡ˆ

å·²å°†è¿™3ä¸ªæ–‡ä»¶é‡å‘½åä¸º `.bak` åç¼€ï¼Œä¸å†è¢«æ‰«æï¼š
- `tts_provider_config.py.bak`
- `tts_task.py.bak`
- `tts_usage_stats.py.bak`

è¿™äº›æ˜¯æœªå®Œæˆçš„åŠŸèƒ½ï¼Œä¸å½±å“å½“å‰ç³»ç»Ÿè¿è¡Œã€‚

## ğŸ” æ‰«ææœºåˆ¶è¯¦è§£

### æ‰«æèŒƒå›´

è‡ªåŠ¨æ‰«æä»¥ä¸‹ç›®å½•ï¼š
- `app/controller/` - æ‰€æœ‰æ§åˆ¶å™¨
- `app/api/` - æ—§ç‰ˆAPIè·¯ç”±ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
- `app/models/entities/` - æ•°æ®æ¨¡å‹ï¼ˆå¯èƒ½ä¼šè§¦å‘å¯¼å…¥ï¼‰

### è·³è¿‡æ‰«æçš„æƒ…å†µ

- æ–‡ä»¶åä»¥ `_` å¼€å¤´
- æ–‡ä»¶åä»¥ `.bak`ã€`.old`ã€`.tmp` ç»“å°¾
- `__pycache__` ç›®å½•
- æµ‹è¯•æ–‡ä»¶ `test_*.py`

### æ‰«æè¿‡ç¨‹

1. **é€’å½’éå†**ï¼šä» `app/controller/` å¼€å§‹ï¼Œé€’å½’æŸ¥æ‰¾æ‰€æœ‰ `.py` æ–‡ä»¶
2. **åŠ¨æ€å¯¼å…¥**ï¼šå°è¯•å¯¼å…¥æ¯ä¸ªæ¨¡å—
3. **æ£€æµ‹è£…é¥°å™¨**ï¼šæŸ¥æ‰¾å¸¦ `@api_controller` è£…é¥°å™¨çš„ç±»
4. **æ³¨å†Œè·¯ç”±**ï¼šå°†è£…é¥°å™¨æ”¶é›†çš„è·¯ç”±ä¿¡æ¯æ³¨å†Œåˆ° FastAPI

## ğŸ“Š å¯¹æ¯”ï¼šæ‰‹åŠ¨ vs è‡ªåŠ¨æ³¨å†Œ

### ä¼ ç»Ÿæ–¹å¼ï¼ˆæ‰‹åŠ¨æ³¨å†Œï¼‰

```python
# main.py
from fastapi import FastAPI
from app.controller.auth_controller import router as auth_router

app = FastAPI()
app.include_router(auth_router)  # æ‰‹åŠ¨æ³¨å†Œ
```

**ä¼˜ç‚¹**ï¼šæ˜ç¡®ã€å¯æ§  
**ç¼ºç‚¹**ï¼šæ¯ä¸ªæ§åˆ¶å™¨éƒ½è¦æ‰‹åŠ¨å¯¼å…¥å’Œæ³¨å†Œï¼Œä»£ç å†—é•¿

### è£…é¥°å™¨æ–¹å¼ï¼ˆè‡ªåŠ¨æ³¨å†Œï¼‰

```python
# auth_controller.py
@api_controller(prefix="/api/auth")
class AuthController:
    @post("/generate")
    async def generate(self):
        pass

# main.py è‡ªåŠ¨æ‰«ææ³¨å†Œï¼Œæ— éœ€æ‰‹åŠ¨å¯¼å…¥
```

**ä¼˜ç‚¹**ï¼šç®€æ´ã€è‡ªåŠ¨åŒ–ã€ç±»ä¼¼ Spring Boot  
**ç¼ºç‚¹**ï¼šéœ€è¦æ‰«ææœºåˆ¶

## ğŸš« å¦‚æœä¸æ‰«æä¼šæ€æ ·ï¼Ÿ

**æ‰€æœ‰ä½¿ç”¨è£…é¥°å™¨å®šä¹‰çš„æ¥å£éƒ½æ— æ³•è®¿é—®ï¼**

æµ‹è¯•ï¼š
```bash
# ä¸æ‰«ææ—¶
curl http://localhost:8000/api/auth/generate
# è¿”å›: {"detail": "Not Found"}  404 é”™è¯¯
```

## ğŸ’¡ å»ºè®®

1. **ä¿æŒè‡ªåŠ¨æ‰«æ**ï¼šè¿™æ˜¯é¡¹ç›®çš„æ ¸å¿ƒæœºåˆ¶
2. **æ¸…ç†æœªä½¿ç”¨ä»£ç **ï¼šå°†ä¸éœ€è¦çš„æ–‡ä»¶ç§»åˆ° `backup/` æˆ–åˆ é™¤
3. **æ£€æŸ¥å¯¼å…¥é”™è¯¯**ï¼šå¯åŠ¨æ—¶å¦‚æœæœ‰è­¦å‘Šï¼Œåº”è¯¥åŠæ—¶ä¿®å¤æˆ–ç§»é™¤é—®é¢˜æ–‡ä»¶

---

**æ€»ç»“**ï¼šæ§åˆ¶å™¨æ‰«ææ˜¯å¿…é¡»çš„ï¼Œå®ƒè®©è£…é¥°å™¨è·¯ç”±ç³»ç»Ÿèƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚ç°åœ¨è­¦å‘Šå·²ç»æ¶ˆé™¤ï¼Œç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼âœ…

